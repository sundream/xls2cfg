// auto generated by xls2cfg,do not edit!!!
using SimpleJSON;
using System.Text;
using System.Collections.Generic;

namespace {{namespace}} {
    // {{classComment}}
    public sealed class {{className}} {
        {% for field in fields -%}
        public readonly {{field.typename}} {{field.name}};   // {{field.comment}}
        {% endfor %}

        public {{className}} () {}

        public {{className}} (JSONNode jsonNode) {
            {% for field in fields -%}
            {{formatFieldFromJson(field.index)}}
            {% endfor %}
        }

        public {{className}} (ByteStream bs) {
            {% for field in fields -%}
            {{formatFieldFromBinary(field.index)}}
            {% endfor %}
        }

        public override string ToString() {
            JSONObject jsonNode = new JSONObject();
            {% for field in fields -%}
            {{formatFieldToString(field.index)}}
            {% endfor %}
            return jsonNode.ToString();
        }

        public static {{className}} DeserializeFromJson(byte[] data) {
            string str = Encoding.UTF8.GetString(data);
            JSONNode jsonNode = JSON.Parse(str);
            return new {{className}}(jsonNode);
        }

        public static {{className}} DeserializeFromBinary(byte[] data) {
            ByteStream bs = ByteStream.GetFromPool();
            bs.CopyBuffer(data);
            {{className}} obj = new {{className}}(bs);
            ByteStream.PutToPool(bs);
            return obj;
        }
    }
}